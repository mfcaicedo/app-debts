<div class="">
    <div class="">
        <h2>
            Tus deudas por gestionar
        </h2>
    </div>
    @if (this.debts.length > 0) {
    <div class="">
        <form action="" [formGroup]="filterForm" (submit)="onSubmit()">
            <div class="card grid">
                <div class="col-12 sm:col-12 pl-0">
                    <div class="col-12 sm:col-6 pl-0">
                        <label for="applicationStatus" class="block text-primary text-lg font-medium mb-2">
                            Estado
                        </label>
                        <p-select class="p-3" [options]="debtStatusDataList" [required]="false" [showClear]="true"
                        formControlName="status" optionValue="value" optionLabel="key" [filter]="true"
                        filterBy="value" placeholder="Seleccione el estado" class="w-full md:w-56" />
                    </div>
                </div>
                <div class="row col-12 sm:col-6 flex flex-row gap-2 pl-0">
                    <button pButton pRipple label="Buscar" type="submit" [disabled]="!filterForm.valid"
                        class="w-full border-round">
                    </button>
                    <button pButton severity="secondary" type="button" pRipple label="Limpiar" [disabled]="false"
                        class="w-full border-round" (click)="cleanFilters()">
                    </button>
                </div>
            </div>
        </form>
    </div>
        
    <p-table #dt1 [value]="debts" [paginator]="true" [rows]="5" [first]="first" [showCurrentPageReport]="true"
        [tableStyle]="{ 'min-width': '50rem' }" selectionMode="single" dataKey="id" 
        [globalFilterFields]="['debtId','description', 'amount', 'status']"
        currentPageReportTemplate="Mostrando {first} - {last} de {totalRecords} solicitudes"
        (onPage)="pageChange($event)" [rowsPerPageOptions]="[5, 10, 15, 20, 25]" dataKey="id">
        <ng-template #caption>
            <div class="flex flex-row">
                <div class="" [ngStyle]="{ 'width': '70%' }">
                    <p-iconfield iconPosition="left">
                        <p-inputicon>
                            <i class="pi pi-search"></i>
                        </p-inputicon>
                        <input pInputText type="text" [ngStyle]="{ 'width': '95%' }" (input)="search($event)"
                            placeholder="Buscar..." />
                    </p-iconfield>
                </div>
                <button pButton pRipple type="button" class="border-round" [ngStyle]="{ 'width': '30%' }"
                    (click)="createDebt()">
                    Crear nueva deuda
                </button>
            </div>
        </ng-template>
        <ng-template #header>
            <tr>
                <th class="text-primary" pSortableColumn="debtId">
                    Id <p-sortIcon field="debtId" />
                </th>
                <th class="text-primary" pSortableColumn="description">
                    Descripci√≥n <p-sortIcon field="description" />
                </th>
                <th class="text-primary" pSortableColumn="amount">
                    Monto <p-sortIcon field="amount" />
                </th>
                <th class="text-primary" pSortableColumn="status">
                    Estado <p-sortIcon field="status" />
                </th>
                <th class="text-primary">Acciones</th>
            </tr>
        </ng-template>
        <ng-template #body let-debt>
            <tr>
                <td>{{ debt.debtId }}</td>
                <td>{{ debt.description }}</td>
                <td>{{ debt.amount }}</td>
                <td>{{ debt.status === 'pending' ? 'PENDIENTE' : 'PAGADA' }}</td>
                <td>
                    <div class="flex justify-between">
                        <button pButton pRipple icon="pi pi-eye" class="p-button-rounded p-button-text"
                            (click)="viewDebt(debt.debtId)">
                            Ver detalle
                        </button>
                        <!-- <button pButton pRipple icon="pi pi-trash" class="p-button-rounded p-button-text text-red-500"
                            (click)="deleteDebt(debt)">
                            Eliminar
                        </button> -->
                    </div>
                </td>
            </tr>
        </ng-template>
    </p-table>
    }
    @else {
    <div class="mt-3">
        <p-message severity="info" text="No hay deudas registradas para usted
            enviadas." icon="pi pi-info-circle">
        </p-message>
    </div>
    }
    <!-- Dialog alert -->
    <p-toast />
    <p-confirmdialog />
</div>